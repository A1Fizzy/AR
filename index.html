<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR с three.js и жестами</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdn.rawgit.com/handtrackjs/handtrackjs/master/dist/handtrack.min.js"></script>
    <style>
        body { margin: 0; }
        canvas { display: block; }
    </style>
</head>
<body>
    <a-scene embedded arjs='sourceType: webcam;'>
        <a-entity id="model" gltf-model="url(https://modelviewer.dev/shared-assets/models/Astronaut.glb)" scale="0.1 0.1 0.1" position="0 0 0"></a-entity>
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        const model = document.getElementById('model');
        let currentScale = 1;

        // Инициализация отслеживания жестов
        const video = document.createElement('video');

        handTrack.startVideo(video).then(status => {
            if (status) {
                console.log("Видео запущено");
                detectHands();
            }
        });

        function detectHands() {
            handTrack.detect(video).then(predictions => {
                if (predictions.length > 0) {
                    const hand = predictions[0];
                    const fingersClosed = hand.landmarks[4][1] < hand.landmarks[3][1]; // Пример: проверка на сжатие пальцев

                    if (fingersClosed) {
                        currentScale += 0.01; // Увеличение масштаба
                    } else {
                        currentScale -= 0.01; // Уменьшение масштаба
                    }

                    model.setAttribute('scale', `${currentScale} ${currentScale} ${currentScale}`);
                }
                requestAnimationFrame(detectHands);
            });
        }
    </script>
</body>
</html>
